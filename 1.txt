CREATE TABLE dbo.ENDERECO (
    ID INT IDENTITY (1, 1) NOT NULL,
    CODIGO VARCHAR(36) NOT NULL,
    ENDERECO VARCHAR(150) NOT NULL,
    BAIRRO VARCHAR(100) NOT NULL,
    CIDADE VARCHAR(100) NOT NULL,
    UF CHAR(2) NOT NULL,
    CEP CHAR(8) NOT NULL,
    COMPLEMENTO VARCHAR(100) NULL,
    NUMERO VARCHAR(5) NOT NULL,
    LATITUDE VARCHAR(20) NULL,
    LONGITUDE VARCHAR(20) NULL,
    EXCLUIDO BIT NOT NULL DEFAULT 0,
    DATE_CREATE DATETIME NOT NULL DEFAULT GETDATE (),
    DATE_UPDATE DATETIME NOT NULL DEFAULT GETDATE (),
    PRIMARY KEY (ID)
);

CREATE TABLE dbo.EMPRESA_ENDERECO (
    ID INT IDENTITY (1, 1) NOT NULL,
    CODIGO VARCHAR(36) NOT NULL,
    EMPRESA_ID INT NOT NULL,
    ENDERECO_ID INT NOT NULL,
    EXCLUIDO BIT NOT NULL DEFAULT 0,
    DATE_CREATE DATETIME NOT NULL DEFAULT GETDATE (),
    DATE_UPDATE DATETIME NOT NULL DEFAULT GETDATE (),
    CONSTRAINT PK_EMPRESA_ENDERECO PRIMARY KEY (ID),
    CONSTRAINT FK_EMPRESA_ENDERECO_EMPRESA FOREIGN KEY (EMPRESA_ID) REFERENCES dbo.EMPRESA (ID) ON DELETE NO ACTION ON UPDATE NO ACTION,
    CONSTRAINT FK_EMPRESA_ENDERECO_ENDERECO FOREIGN KEY (ENDERECO_ID) REFERENCES dbo.ENDERECO (ID) ON DELETE NO ACTION ON UPDATE NO ACTION
);

CREATE INDEX IDX_EMPRESA_ENDERECO_EMPRESA ON dbo.EMPRESA_ENDERECO (EMPRESA_ID);

CREATE INDEX IDX_EMPRESA_ENDERECO_ENDERECO ON dbo.EMPRESA_ENDERECO (ENDERECO_ID);

CREATE TABLE [dbo].[EMPRESA] (
  [ID] INT IDENTITY(1,1) NOT NULL,
  [CODIGO] VARCHAR(36) NOT NULL,
  [RAZAO_SOCIAL] VARCHAR(100) NOT NULL,
  [FANTASIA] VARCHAR(100) NOT NULL,
  [TIPO_DOCUMENTO] VARCHAR(4) NOT NULL,
  [DOCUMENTO] VARCHAR(14) NOT NULL,
  [UPDATE] BIT NOT NULL DEFAULT 1,
  [EXCLUIDO] BIT NOT NULL DEFAULT 0,
  [DATE_CREATE] DATETIME NOT NULL DEFAULT GETDATE(),
  [DATE_UPDATE] DATETIME NOT NULL DEFAULT GETDATE(),
  PRIMARY KEY ([ID])
);

CREATE TABLE dbo.PESSOA (
    ID INT IDENTITY (1, 1) NOT NULL,
    CODIGO VARCHAR(36) NOT NULL,
    NOME VARCHAR(100) NOT NULL,
    CPF CHAR(11) NOT NULL,
    NASCIMENTO DATETIME NOT NULL,
    GENERO CHAR(1) NOT NULL,
    ESTADO_CIVIL_ID INT NOT NULL,
    NACIONALIDADE VARCHAR(40) NOT NULL,
    NATURALIDADE VARCHAR(40) NOT NULL,
    EXCLUIDO BIT NOT NULL DEFAULT 0,
    DATA_CREATE DATETIME NOT NULL DEFAULT GETDATE (),
    DATA_UPDATE DATETIME NOT NULL DEFAULT GETDATE (),
    PRIMARY KEY (ID),
    CONSTRAINT UQ_CPF UNIQUE (CPF)
);

CREATE TABLE dbo.PESSOA_ENDERECO (
    ID INT NOT NULL IDENTITY (1, 1),
    CODIGO VARCHAR(36) NOT NULL,
    PESSOA_ID INT NOT NULL,
    ENDERECO_ID INT NOT NULL,
    EXCLUIDO BIT NOT NULL DEFAULT 0,
    DATE_CREATE DATETIME NOT NULL DEFAULT GETDATE (),
    DATE_UPDATE DATETIME NOT NULL DEFAULT GETDATE (),
    PRIMARY KEY (ID),
    CONSTRAINT PESSOA_ENDERECO_PESSOA FOREIGN KEY (PESSOA_ID) REFERENCES dbo.PESSOA (ID) ON DELETE NO ACTION ON UPDATE NO ACTION,
    CONSTRAINT PESSOA_ENDERECO_ENDERECO FOREIGN KEY (ENDERECO_ID) REFERENCES dbo.ENDERECO (ID) ON DELETE NO ACTION ON UPDATE NO ACTION
);

CREATE TABLE [dbo].[PESSOA_EMPRESA] (
  [ID] INT IDENTITY(1,1) NOT NULL,
  [CODIGO] VARCHAR(36) NOT NULL,
  [PESSOA_ID] INT NOT NULL,
  [EMPRESA_ID] INT NOT NULL,
  [EXCLUIDO] BIT NOT NULL DEFAULT 0,
  [DATE_CREATE] DATETIME NOT NULL DEFAULT GETDATE(),
  [DATE_UPLOAD] DATETIME NOT NULL DEFAULT GETDATE(),
  PRIMARY KEY ([ID])
);

CREATE INDEX [FK_PESSOA_TIPO_EMPRESA_idx] ON [dbo].[PESSOA_EMPRESA]([EMPRESA_ID]);

CREATE INDEX [FK_PESSOA_PESSOA_idx] ON [dbo].[PESSOA_EMPRESA]([PESSOA_ID]);

ALTER TABLE [dbo].[PESSOA_EMPRESA] ADD CONSTRAINT [FK_PESSOA_PESSOA]
  FOREIGN KEY ([PESSOA_ID]) REFERENCES [dbo].[PESSOA]([ID]) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE [dbo].[PESSOA_EMPRESA] ADD CONSTRAINT [FK_PESSOA_EMPRESA]
  FOREIGN KEY ([EMPRESA_ID]) REFERENCES [dbo].[EMPRESA]([ID]) ON DELETE NO ACTION ON UPDATE NO ACTION;
